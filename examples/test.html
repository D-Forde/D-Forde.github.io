<!doctype html>
	<link type="text/css" rel="stylesheet" href="../src/css/graph.css">
	<link type="text/css" rel="stylesheet" href="../src/css/detail.css">
	<link type="text/css" rel="stylesheet" href="../src/css/legend.css">

	<script src="../vendor/d3.v3.js"></script>

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>

	<script src="../rickshaw.js"></script>
		<style>
		body { 
			font-family: Arial, sans-serif 
		}
		#chart{
			left:40px;
		}
		#y_axis {
			position: absolute;
			top: 0;
			bottom: 0;
			width: 40px;
		}
		#x_axis {
			position: relative;
			left: 40px;
			height: 40px;
		}
	</style>
	<div id="y_axis"></div>
	<div id="chart"></div>
	<div id="x_axis"></div>
	<div id="legend"></div>
<script>
var seriesData = [[], []];
var random = new Rickshaw.Fixtures.RandomData(100);

for (var i = 0; i < 5; i++) {
	random.addData(seriesData);
}




var graph = new Rickshaw.Graph( {
	width: 1000,
	element: document.getElementById("chart"),
	renderer: 'lineplot',
	padding: { top: 0.1 },
	series: [
		{
			color: "#c05020",
			data: seriesData[0],
			name: 'BPM'
		}
	]
} );
var format = function(n) {

	var map = {
		0: 'zero',
		1: 'first',
		2: 'second',
		3: 'third',
		4: 'fourth'
	};

	return map[n];
}

var x_ticks = new Rickshaw.Graph.Axis.X( {
	graph: graph,
	orientation: 'bottom',
	element: document.getElementById('x_axis'),
	pixelsPerTick: 200,
	tickFormat: format
} );
var y_ticks = new Rickshaw.Graph.Axis.Y( {
	graph: graph,
	orientation: 'left',
	tickFormat: Rickshaw.Fixtures.Number.formatKMBT,
	element: document.getElementById('y_axis')
} );

graph.render();

var legend = document.querySelector('#legend');

var Hover = Rickshaw.Class.create(Rickshaw.Graph.HoverDetail, {

	render: function(args) {

		legend.innerHTML = args.formattedXValue;

		args.detail.sort(function(a, b) { return a.order - b.order }).forEach( function(d) {

			var line = document.createElement('div');
			line.className = 'line';

			var swatch = document.createElement('div');
			swatch.className = 'swatch';
			swatch.style.backgroundColor = d.series.color;

			var label = document.createElement('div');
			label.className = 'label';
			label.innerHTML = d.name + ": " + d.formattedYValue;

			line.appendChild(swatch);
			line.appendChild(label);

			legend.appendChild(line);

			var dot = document.createElement('div');
			dot.className = 'dot';
			dot.style.top = graph.y(d.value.y0 + d.value.y) + 'px';
			dot.style.borderColor = d.series.color;

			this.element.appendChild(dot);

			dot.className = 'dot active';

			this.show();

		}, this );
        }
});

var hover = new Hover( { graph: graph } ); 

</script>
